trigger:
- master

pool:
  name: MyAGPool_VM-SQLSVR-TMG-F
  demands: msbuild

variables:
- name: My-VG-RAN
  value: 'value of my VG'
- group: DEV-VG
- name: DEV-VG
  value: $[variables.DBServerName]

steps:
- script: echo $(My-VG-RAN)
- script: echo $(DEV-VG)
- task: MSBuild@1
  displayName: 'Build solution'
  inputs:
    solution: 'SSRS_REPORT'

- task: CopyFiles@2
  inputs:
    SourceFolder: 'SSRS_REPORT'
    Contents: '**'
    TargetFolder: '$(build.artifactstagingdirectory)'

- task: PowerShell@2
  displayName: 'PowerShell Script'
  inputs:
    filePath: '$(build.artifactstagingdirectory)/DeploySSRSReportsTesting.ps1'
    arguments: '$(DataSourceFolder) $(build.artifactstagingdirectory)/$(DataSourceFile) $(ReportServerUri) $(DBServerName) $(DatabaseName) $(TargetFolder) $(DataSourceUserName) $(DataSourcePassword)'


